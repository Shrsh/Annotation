<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<title>Draw a rectangle!</title>

</head>

<body>
<h4>Click to assign polygon vertices</h4>
<button id="done">Click when done assigning points</button>
<button id="clear">Click to Clear</button>
<br><canvas id="canvas" width=700 height=700></canvas>
<style>
body{ background-color: ivory; }
#canvas{
    padding-left: 0;
    padding-right: 0;
    margin-left: auto;
    margin-right: auto;
    display: block;
    width: 800px;
    border:1px solid red;
}
</style>
<script>
        var canvas=document.getElementById("canvas");
        var context=canvas.getContext("2d");
        var cw=canvas.width;
        var ch=canvas.height;
        function reOffset(){
          var BB=canvas.getBoundingClientRect();
          offsetX=BB.left;
          offsetY=BB.top;        
        }
        var offsetX,offsetY;
        reOffset();
        window.onscroll=function(e){ reOffset(); }
        
        context.lineWidth=5;
        context.strokeStyle='blue';
        
        var coordinates = [];
        
        var isDone=false;
        
        $('#done').click(function(){
          isDone=true;
          context.closePath();
          context.stroke();
        });

        $('#clear').click(function(){
            context.clearRect(0, 0, cw,ch);
            while(coordinates.length > 0){
              coordinates.pop();
          };
        });
        
        $("#canvas").mousedown(function(e){
          isDone = false;
          handleMouseDown(e);
        });
        
        function handleMouseDown(e){
          if(isDone || coordinates.length>40)
          {
              console.log(isDone);
              return;
          }
          // tell the browser we're handling this event
          e.preventDefault();
          e.stopPropagation();
        
          mouseX=parseInt(e.clientX-offsetX);
          mouseY=parseInt(e.clientY-offsetY);
          console.log(mouseX, mouseY);
          coordinates.push({x:mouseX,y:mouseY});
          drawPolygon();
        }
        
        function drawPolygon(){
          context.clearRect(0,0,cw,ch);
          context.beginPath();
          context.moveTo(coordinates[0].x, coordinates[0].y);
          for(index=1; index<coordinates.length;index++) {
            context.lineTo(coordinates[index].x, coordinates[index].y);
          }
          
        }
</script>
</body>
</html>